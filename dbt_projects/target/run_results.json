{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-12-17T06:00:09.723104Z", "invocation_id": "ef9775b5-21e7-468d-888e-c5d1d4eb4b75", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T06:00:08.717882Z", "completed_at": "2025-12-17T06:00:08.741329Z"}, {"name": "execute", "started_at": "2025-12-17T06:00:08.742939Z", "completed_at": "2025-12-17T06:00:09.010600Z"}], "thread_id": "Thread-1", "execution_time": 0.29671716690063477, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.eratani_dbt.stg_agriculture", "compiled": true, "compiled_code": "select\r\n    trim(farm_id) as farm_id,\r\n    trim(crop_type) as crop_type,\r\n    cast(farm_area_acres as numeric) as farm_area_acres,\r\n    trim(irrigation_type) as irrigation_type,\r\n    cast(fertilizer_used_tons as numeric) as fertilizer_used_tons,\r\n    cast(pesticide_used_kg as numeric) as pesticide_used_kg,\r\n    cast(yield_tons as numeric) as yield_tons,\r\n    trim(soil_type) as soil_type,\r\n    trim(season) as season,\r\n    cast(water_usage_cubic_meters as numeric) as water_usage_cubic_meters\r\nfrom public.staging_agriculture\r\nwhere\r\n    farm_id is not null\r\n    and crop_type is not null\r\n    and yield_tons is not null", "relation_name": "\"airflow\".\"public\".\"stg_agriculture\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T06:00:09.025388Z", "completed_at": "2025-12-17T06:00:09.045010Z"}, {"name": "execute", "started_at": "2025-12-17T06:00:09.046244Z", "completed_at": "2025-12-17T06:00:09.246365Z"}], "thread_id": "Thread-1", "execution_time": 0.22516989707946777, "adapter_response": {"_message": "SELECT 50", "code": "SELECT", "rows_affected": 50}, "message": "SELECT 50", "failures": null, "unique_id": "model.eratani_dbt.fact_farm_production", "compiled": true, "compiled_code": "select\n    farm_id,\n    crop_type,\n    farm_area_acres,\n    irrigation_type,\n    fertilizer_used_tons,\n    pesticide_used_kg,\n    yield_tons,\n    soil_type,\n    season,\n    water_usage_cubic_meters\nfrom \"airflow\".\"public\".\"stg_agriculture\"", "relation_name": "\"airflow\".\"public\".\"fact_farm_production\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T06:00:09.262836Z", "completed_at": "2025-12-17T06:00:09.365344Z"}, {"name": "execute", "started_at": "2025-12-17T06:00:09.367858Z", "completed_at": "2025-12-17T06:00:09.506601Z"}], "thread_id": "Thread-1", "execution_time": 0.2501230239868164, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.eratani_dbt.agriculture_metrics", "compiled": true, "compiled_code": "select\n    crop_type,\n    season,\n\n    sum(yield_tons) as total_yield_tons,\n\n    sum(yield_tons) / nullif(sum(farm_area_acres), 0)\n        as yield_per_acre,\n\n    sum(yield_tons) / nullif(sum(fertilizer_used_tons), 0)\n        as fertilizer_efficiency,\n\n    sum(yield_tons) / nullif(sum(water_usage_cubic_meters), 0)\n        as water_productivity\n\nfrom \"airflow\".\"public\".\"fact_farm_production\"\ngroup by\n    crop_type,\n    season", "relation_name": "\"airflow\".\"public\".\"agriculture_metrics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T06:00:09.527128Z", "completed_at": "2025-12-17T06:00:09.559570Z"}, {"name": "execute", "started_at": "2025-12-17T06:00:09.562133Z", "completed_at": "2025-12-17T06:00:09.688586Z"}], "thread_id": "Thread-1", "execution_time": 0.1675567626953125, "adapter_response": {"_message": "SELECT 26", "code": "SELECT", "rows_affected": 26}, "message": "SELECT 26", "failures": null, "unique_id": "model.eratani_dbt.agriculture_metrics_daily", "compiled": true, "compiled_code": "with base as (\n    select * from \"airflow\".\"public\".\"fact_farm_production\"\n),\n\n-- base metrics\nmetrics as (\n    select\n        crop_type,\n        season,\n        irrigation_type,\n\n        sum(yield_tons) as total_yield_tons,\n        sum(yield_tons) / nullif(sum(farm_area_acres), 0) as yield_per_acre,\n        sum(yield_tons) / nullif(sum(fertilizer_used_tons), 0) as fertilizer_efficiency,\n        sum(yield_tons) / nullif(sum(water_usage_cubic_meters), 0) as water_productivity\n    from base\n    group by crop_type, season, irrigation_type\n),\n\n-- top 3 crops by yield per acre\ntop_crops as (\n    select\n        crop_type,\n        yield_per_acre,\n        dense_rank() over (order by yield_per_acre desc) as crop_rank\n    from (\n        select\n            crop_type,\n            sum(yield_tons) / nullif(sum(farm_area_acres), 0) as yield_per_acre\n        from base\n        group by crop_type\n    ) t\n),\n\n-- top 3 irrigation methods by avg yield\ntop_irrigation as (\n    select\n        irrigation_type,\n        avg(yield_tons) as avg_yield,\n        dense_rank() over (order by avg(yield_tons) desc) as irrigation_rank\n    from base\n    group by irrigation_type\n)\n\nselect\n    m.crop_type,\n    m.season,\n    m.irrigation_type,\n    m.total_yield_tons,\n    m.yield_per_acre,\n    m.fertilizer_efficiency,\n    m.water_productivity,\n\n    tc.crop_rank,\n    ti.irrigation_rank\n\nfrom metrics m\nleft join top_crops tc\n    on m.crop_type = tc.crop_type\nleft join top_irrigation ti\n    on m.irrigation_type = ti.irrigation_type\n\nwhere\n    tc.crop_rank <= 3\n    or ti.irrigation_rank <= 3", "relation_name": "\"airflow\".\"public\".\"agriculture_metrics_daily\""}], "elapsed_time": 1.1861300468444824, "args": {"project_dir": "/opt/dbt_projects", "print": true, "defer": false, "which": "run", "indirect_selection": "eager", "require_resource_names_without_spaces": false, "require_explicit_package_overrides_for_builtin_materializations": true, "favor_state": false, "show_resource_report": false, "printer_width": 80, "partial_parse": true, "empty": false, "enable_legacy_logger": false, "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "vars": {}, "use_colors": true, "introspect": true, "source_freshness_run_project_hooks": false, "version_check": true, "quiet": false, "macro_debugging": false, "populate_cache": true, "log_path": "/opt/dbt_projects/logs", "partial_parse_file_diff": true, "invocation_command": "dbt run", "use_colors_file": true, "cache_selected_only": false, "log_level_file": "debug", "exclude": [], "profiles_dir": "/opt/dbt_projects", "log_format_file": "debug", "select": [], "log_format": "default", "strict_mode": false, "static_parser": true, "log_file_max_bytes": 10485760, "write_json": true, "send_anonymous_usage_stats": true}}